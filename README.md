---
defaults: github-markdown
toc: false
---
<!-- *********************************************************************** -->
# matrixxx-initrd-build
- This repository is primarily a shell script collection to generate a special
  initramfs for matrixxx (a D.I.Y linux live system)
  - scripts to generate a **customized busybox**
  - scripts to generate a **customized initramfs**
    (regardless of the kernel used)
- The result is an initramfs in the form of a gzip cpio file that can be
  started by the Linux kernel and can be controlled via kernel parameters
  - Including a 32-bit busybox executable with associated file structure
    and program softlinks
  - This initramfs is specialized to mount
    - the USB-Stick (or similar) on which the initramfs is located (boot device)
    - an 'union-mouted-filesystem' in overlay structure
      - consisting of a variety of writing-protected images (type of squasfs)
        and a layer above, which can be written
  - Furthermore, this initramfs is designed for (simple) remastering

#### briefly:
- see [readme: about][]
<!--
- see [readme: process][]
- see [readme: usage][]
-->

#### links:
- home page of [busybox][]

<!-- *********************************************************************** -->
[busybox]: https://www.busybox.net/
[readme: about]: doc/readme-matrixxx.md
[readme: process]: doc/readme-process.md
[readme: usage]: doc/readme-usage.md

********************************************************************************
### Content of matrixxx-initrd-build.git:
- **[dir]**
  **[01-scripts-build-initrd-busybox](#build-initrd-busybox)**
  - contains the scripts for busybox build
- **[dir]**
  **[02-scripts-build-initrd](#build-initrd)**
  - contains the scripts for initrd (resp. initramfs) build
- **[dir]** **archives**
  - will be used by *'01-scripts-build-initrd-busybox'*
  - contains splited versions of current release version
    - initrd-matrixxx.tar.xz contains current release of init scripts
    - busybox-install.tar.xz current release of busybox structure
      - generated by *'01-scripts-build-initrd-busybox'*
    - initrd-matrixxx-base.tar.xz current release of initramfs structure
- **[dir]** doc
  - contains additional readme files
- **[dir]** lib
  - contains some libraries of common script functions
- **[dir]**
 [scripts-extract-initrd](#extract-initrd)
  - contains a script for extraction existing initrd (resp. initramfs) files
- LICENSE
  - *GNU GENERAL PUBLIC LICENSE* [[text]](LICENSE)
- README.md
  - *briefly description about the matrixxx-initrd-build.git* (this file)

********************************************************************************
#### Content of '01-scripts-build-initrd-busybox': <a name="build-initrd-busybox"/>
> [!CAUTION]
> The copilation of busybox does not work with any kernel!
> The current version of BusyBox was created with a matrixxx
> specific **32bit kernel of version 6.7.5**

> [!TIP]
> To find a new version use **00-script-get-busybox-repository.sh** and
> check 'git branch -a'. If you found a new version you can adapt
> RELEASE_BRANCH="1_37_stable" in ./init to generate this new version.
> Otherwise jump to [02-scripts-build-initrd](#build-initrd)

- **00-script-get-busybox-repository.sh**
  - generates the basic output directory where the Git repository will be stored
- **00-script-set-busybox-repository-default.sh**
  - sets up the git repository with the selected view (version)
    - corresponding configuration in the script
- **01-script-build-busybox\--transcription.sh**
  - wrapper over **script-build-busybox.sh** to generate a transcription of the
    build output (tool used is 'script')
- **02-script-build-busybox-pack.sh**
  - generates a tar file of the generated BusyBox structure (can be copied to
    dir: archives as a basis for creating the initramfs)
- init
  - global defines (and functions); included in all scripts
- script-build-busybox.sh
  - actual build of busybox (configuration and compilation)
- script-build-busybox\--transcription_show_result.sh
  - show a transcription file (tool used is 'less')
- script-get-c-libraries-repository.sh
  - *TODO:* get other C libraries
- **XX-build-process.sh**
  - Complete busybox build process (with the default configuration)

********************************************************************************
#### Content of '02-scripts-build-initrd': <a name="build-initrd"/>
- **00-script-build-working-dir.sh**
  - generates the basic output directory in which a working directory is created
  - unpacking the TAR files from archives directory in the working directory
    [busybox '1_37_stable' is included]
- **01-script-set-working-link.sh**
  - create a working link to working directory
- **02-script-build_InitalRD.sh**
  - actual build of the initramfs - a cpio archive (compressed with gzip)
    (directory 'new' contains the output)
- **03-script-store-working-dir.sh**
  - create TAR files for update the archive directory
    (splited versions of current release version)
  - **!** no automatic overwriting of the archive directory
- init
  - global defines; included in all scripts
- script-del-new-dir.sh
- script-del-working-link.sh

********************************************************************************
#### Content of 'scripts-extract-initrd': <a name="extract-initrd"/>
- **[dir]** originals
  - Copy initramfs here that should be unpacked
- **01-script-extract_InitRD.sh**
  - generates the basic output directory in which the initramfs should be
    extracted (corresponding configuration in init)
- init
  - global defines; included in all scripts

##### example:
- Use **'02-scripts-build-initrd'** to build a compressed cpio archive
  (step 00 - 02)
- copy result from directory 'new' to 'originals/matrixxx-1.1'
- adapt init by uncomment "matrixxx-1.1/initrd.gz"
- now you find the uncompressed version under 'extract-initrd/matrixxx-1.1'

********************************************************************************


